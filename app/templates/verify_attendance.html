<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        /* Add centering styles for the table */
        .centered-table {
            margin: 0 auto; /* Center the table horizontally */
            width: 80%; /* Adjust the width as needed */
        }
    </style>
    <title>Verify Attendance</title>
</head>
<body>
    <header>
        <h1>Verify Attendance</h1>
    </header>
    <div class="container">
        <h2>Attendees</h2>
        <table class="centered-table">
            <thead>
                <tr>
                    <th>Timestamp</th>
                </tr>
            </thead>
            <tbody id="attendeesTable">
                <!-- Attendees will be added here dynamically -->
            </tbody>
        </table>
        <h2>Total Attendees: <span id="totalAttendees">0</span></h2>
        <a href="{{ url_for('submit_class_professor')}}" class="button">Go Back to Course Selection</a>
        <a href="{{ url_for('professor_attendance_page')}}" class="button">Go Back to Previous Page</a>
    </div>
    <script>
        // Function to update the attendees table and counter
        function updateAttendees(attendeesData) {
            const attendeesTable = document.getElementById("attendeesTable");
            const totalAttendees = document.getElementById("totalAttendees");
            attendeesTable.innerHTML = ""; // Clear the table

            attendeesData.forEach((timestamp, index) => {
                const row = attendeesTable.insertRow();
                const cell = row.insertCell(0);
                cell.textContent = new Date(timestamp * 1000).toLocaleString();
            });

            totalAttendees.textContent = attendeesData.length;
        }

        // Fetch attendees data from the server
        fetch("/view_attendees")
            .then((response) => response.json())
            .then((data) => {
                if (data.attendees && data.attendees.length > 0) {
                    updateAttendees(data.attendees);
                }
            })
            .catch((error) => console.error("Error fetching attendees data: " + error));
    </script>
</body>
</html>
